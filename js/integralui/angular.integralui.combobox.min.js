/*
  filename: angular.integralui.combobox.min.js
  version : 1.0.0
  Copyright © 2014-2015 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUIComboBoxService",["$rootScope","IntegralUIPublicService",function(b,k){return{}}]).controller("IntegralUIComboBoxController",["$scope","$element","IntegralUIInternalService",function(b,k,n){var g=this;g.defaultStyle={general:"iui-combobox"};g.options={controlStyle:g.defaultStyle,dataFields:{content:"content",enabled:"enabled",icon:"icon",style:"style",text:"text"},dropDownHeight:100,dropDownWidth:200,integralHeight:!0,itemIcon:"",maxDropDownItems:7,rtl:!1,selectedItem:null,showIcons:!0};this.updateOptions=function(b){g.options={controlStyle:g.updateControlStyle(b.controlStyle),dataFields:g.updateDataFields(b.dataFields),dropDownHeight:n.isFieldAvailable(b.dropDownHeight,100),dropDownWidth:n.isFieldAvailable(b.dropDownWidth,200),integralHeight:n.isFieldAvailable(b.integralHeight,!0),itemIcon:n.isFieldAvailable(b.itemIcon,""),maxDropDownItems:n.isFieldAvailable(b.maxDropDownItems,7),rtl:n.isFieldAvailable(b.rtl,!1),selectedItem:n.isFieldAvailable(b.selectedItem,null),showIcons:n.isFieldAvailable(b.showIcons,!0)}};this.updateControlStyle=function(b){g.options.controlStyle={general:n.isFieldAvailable(b.general,"iui-combobox")}};this.callCheckedChanged=function(f){angular.isDefined(b.events)&&b.events.checkedChanged&&b.events.checkedChanged();b.checkedChanged()};this.callCheckStateChanged=function(f){angular.isDefined(b.events)&&b.events.checkStateChanged&&b.events.checkStateChanged();b.checkStateChanged()};b.$watch("controlStyle",function(b,e){b!==e&&(g.options.controlStyle=b,g.updateLayout())});b.$watch("dropdownHeight",function(b,e){b!==e&&(g.options.dropDownHeight=b,g.updateLayout())});b.$watch("dropdownWidth",function(b,e){b!==e&&(g.options.dropDownWidth=b,g.updateLayout())});b.$watch("fields",function(b,e){b!==e&&(g.options.dataFields=b,g.UpdateData())});b.$watch("integralHeight",function(b,e){b!==e&&(g.options.integralHeight=b)});b.$watch("itemIcon",function(b,e){b!==e&&(g.options.itemIcon=b,g.updateLayout())});b.$watch("maxDropdownItems",function(b,e){b!==e&&(g.options.maxDropDownItems=b)});b.$watch("showIcons",function(b,e){b!==e&&(g.options.showIcons=b,g.updateLayout())});b.$watch("rtl",function(b,e){b!==e&&(g.options.rtl=b,g.updateLayout())});b.$watch("selectedItem",function(b,e){b!==e&&g.selectItem(b)});g.selectItem=function(f){angular.isDefined(b.selectedItem)?b.selectedItem=f:g.options.selectedItem=f;g.updateCombo()}}]).directive("iuiCombobox",["$compile","$timeout","$window","IntegralUIInternalService","IntegralUIListCtrlService",function(b,k,n,g,f){return{restrict:"EA",controller:"IntegralUIComboBoxController",transclude:!0,replace:!0,template:'<div data-element="combobox"><span class="iui-combobox-content">Test</span><span class="iui-combobox-button iui-combobox-button-dropdown"></span><span></span></div>',scope:{controlStyle:"=",dropdownHeight:"=",dropdownWidth:"=",fields:"=",integralHeight:"=",itemIcon:"=",items:"=",maxDropdownItems:"=",name:"@",options:"=?",rtl:"=",selectedItem:"=",showIcons:"=",events:"=?",dropdownClosed:"=?",dropdownClosing:"=?",dropdownOpened:"=?",dropdownOpening:"=?",selectedItemChanged:"=?"},link:function(e,l,a,h,d){var q=this,r=l.children().eq(0),G=l.children().eq(1),z=g.getUniqueId(4),c=null,t='<iui-list name="'+z+'" style="position:absolute;" items="items" nav-selection="false" after-select="onItemSelected(e)"></iui-list>',m=b(t)(e),u=0,w=0,x=0,F=function(){if(c&&angular.isDefined(e.items)&&0<e.items.length){var a=g.getUniqueId(4),d=b('<iui-list name="'+a+'" style="position:absolute;top:-99px;height:100px" items="items" item-icon="itemIcon"></iui-list>')(e);angular.element(c).append(d);f.updateLayout(a);var t=k(function(){if(0<d.children().length){var c=d.children().eq(0);0<c.children().length&&(x=angular.element(c.children().eq(0))[0].offsetHeight)}d.remove();k.cancel(t)},1)}},A=function(a){m&&m.remove();if(c){m=b(t)(e);F();var d=k(function(){l.css("border-bottom-left-radius","0px");l.css("border-bottom-right-radius","0px");var a=l[0].getBoundingClientRect(),b=angular.element(n)[0].pageXOffset,t=angular.element(n)[0].pageYOffset,t=a.bottom+t-1,a=a.left+b,b=parseInt(getComputedStyle(l[0]).width,10);b<h.options.dropDownWidth&&(b=h.options.dropDownWidth);var e=h.options.dropDownHeight;h.options.integralHeight&&(e=x*h.options.maxDropDownItems);m.css("top",t+"px");m.css("left",a+"px");m.css("width",b+"px");m.css("height",e+"px");m.css("z-index","999");angular.element(c).append(m);f.selectedItem(z,h.options.selectedItem);f.updateLayout(z);f.focus(z,h.options.selectedItem);k.cancel(d)},1)}},D=function(){m&&(m.remove(),l.css("border-bottom-left-radius",u+"px"),l.css("border-bottom-right-radius",w+"px"),l[0].focus())};e.$on("destroy",function(c){l.unbind("click dblclick keydown mousedown mouseleave mousemove");angular.element(n).unbind("click mousemove mouseup");itemScope&&itemScope.$destroy()});e.onItemSelected=function(c){h.selectItem(c.item);D()};l.bind("click",function(c){A(c);c.stopPropagation()});l.bind("keydown",function(c){switch(c.keyCode){case 13:A(c),c.stopPropagation()}});angular.element(n).bind("click",function(c){D()});h.updateLayout=function(){l.removeAttr("class");l.addClass(h.defaultStyle.general);h.options.controlStyle&&g.isString(h.options.controlStyle.general)&&l.addClass(h.options.controlStyle.general);var a=k(function(){c=g.getBodyElem(l[0]);u=parseInt(getComputedStyle(l[0])["border-bottom-left-radius"],10);w=parseInt(getComputedStyle(l[0])["border-bottom-right-radius"],10);var d="ltr";!0===h.options.rtl&&(d="rtl");l.css("direction",d);r.css("width",l[0].clientWidth-G[0].offsetWidth-8+"px");k.cancel(a)},1)};h.updateCombo=function(){r.html(h.options.selectedItem[h.options.dataFields.text])};q=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(c){var a;a="<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>";a+=c[1]+c[4]+c[2]+c[0]+c[3];return a+="</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(q.tpar));this.tmp=300;this.twp=200*tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",l[0].scrollTop+"px"),this.$tw.css("left",l[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",l[0].scrollTop+"px"),this.$tw.css("left",l[0].scrollLeft+"px"))};this.s1t=function(c){this.trlTime=k(function(){q.trActive||(q.trCount=0,q.trActive=!0,q.trId=$interval(function(){q.animTr()},1E3))},c)};this.s2t=function(){this.trId&&($interval.clear(this.trId),this.trId=null);this.trlTime&&(k.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};l.append(this.$tw);this.s1t(this.twp);angular.isDefined(e.options)?h.updateOptions(e.options):(angular.isDefined(e.controlStyle)&&h.updateControlStyle(e.controlStyle),angular.isDefined(e.dropdownHeight)&&(h.options.dropDownHeight=e.dropdownHeight),angular.isDefined(e.dropdownWidth)&&(h.options.dropDownWidth=e.dropdownWidth),angular.isDefined(e.fields)&&(h.updateDataFields(e.fields),h.updateData()),0==e.integralHeight&&(h.options.integralHeight=e.integralHeight),angular.isDefined(e.itemIcon)&&(h.options.itemIcon=e.itemIcon),angular.isDefined(e.maxDropdownItems)&&(h.options.maxDropDownItems=e.maxDropdownItems),1==e.rtl&&(h.options.rtl=e.rtl),angular.isDefined(e.selectedItem)&&(h.options.selectedItem=e.selectedItem),0==e.showIcons&&(h.options.showIcons=e.showIcons));h.updateLayout()}}}]).controller("IntegralUIListCtrlController",["$scope","$element","$timeout","$window","IntegralUIInternalService","IntegralUIDataService","IntegralUIPublicService","IntegralUIListCtrlService","IntegralUIFilter",function(b,k,n,g,f,e,l,a,h){var d=this;d.hoverItem=null;this.suppressProcess=!1;d.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};d.defaultStyle={general:"iui-list",item:{general:{disabled:"iui-list-item-disabled",focused:"iui-list-item-focused",normal:"iui-list-item",hovered:"iui-list-item-hovered",selected:"iui-list-item-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},content:{disabled:"iui-list-item-content-disabled",focused:"iui-list-item-content-focused",normal:"iui-list-item-content",hovered:"iui-list-item-content-hovered",selected:"iui-list-item-content-selected"}}};d.defaultCheckBoxSettings={autoCheck:!1,style:d.defaultCheckBoxStyle,threeState:!1};d.options={allowFocus:!0,autoCheck:!1,checkBoxSettings:d.defaultCheckBoxSettings,controlStyle:d.defaultStyle,dataFields:{checkBoxSettings:"checkBoxSettings",checked:"checked",checkState:"checkState",content:"content",enabled:"enabled",icon:"icon",id:"id",items:"items",style:"style",text:"text"},itemIcon:"",navSelection:!0,rtl:!1,selectedIndex:-1,selectedItem:null,showCheckBoxes:!1,showIcons:!0};b.$on(b.name+"-add-item",function(c,a){d.dataObj.insertAt(a,-1,null,d.itemIsAdded)});b.$on(b.name+"-clear-items",function(c){d.dataObj.clear(null,d.itemIsRemoved);parent||d.setScrollPos({x:0,y:0})});b.$on(b.name+"-insert-item-at",function(c,a,b){d.dataObj.insertAt(a,b,null,d.itemIsAdded)});b.$on(b.name+"-insert-item-after",function(c,a,b){d.dataObj.insertByRef(a,b,!0,d.itemIsAdded)});b.$on(b.name+"-insert-item-before",function(c,a,b){d.dataObj.insertByRef(a,b,!1,d.itemIsAdded)});b.$on(b.name+"-remove-item",function(c,a){d.dataObj.removeAt(a,-1,null,d.itemIsRemoved)});b.$on(b.name+"-remove-item-at",function(c,a){d.dataObj.removeAt(null,a,null,d.itemIsRemoved)});this.itemIsAdded=function(){d.updateLayout()};this.itemIsRemoved=function(c,a){d.updateLayout()};this.objIsRemoved=function(c,a){d.updateLayout()};this.getCheckValue=function(c){return"checked"==c[d.options.dataFields.checkState]?"checked":1==d.options.checkBoxSettings.threeState&&"indeterminate"==c[d.options.dataFields.checkState]?"indeterminate":"unchecked"};this.changeCheckValue=function(c){if(1==d.options.autoCheck||1==d.options.checkBoxSettings.autoCheck){var a=d.getCheckValue(c),m=!1,m=1==d.options.checkBoxSettings.threeState?d.callCheckValueChanging(c,a):d.callCheckValueChanging(c,"checked"==a?!0:!1);if(!1!==m){if(1==d.options.checkBoxSettings.threeState)switch(a){case "checked":a="unchecked";break;case "indeterminate":a="checked";break;case "unchecked":a="indeterminate"}else a="unchecked"==a||"indeterminate"==a?"checked":"unchecked";c[d.options.dataFields.checkState]=a;c[d.options.dataFields.checked]="checked"==a?!0:!1;b.$apply()}}};this.callCheckValueChanging=function(c,a){var m=!0;d.allowEvents&&(m=1==d.options.checkBoxSettings.threeState?angular.isDefined(b.events)&&b.events.itemCheckstateChanging?b.events.itemCheckstateChanging({item:c,value:a}):b.itemCheckstateChanging({e:{item:c,value:a}}):angular.isDefined(b.events)&&b.events.itemCheckedChanging?b.events.itemCheckedChanging({item:c,value:a}):b.itemCheckedChanging({e:{item:c,value:a}}));return m};this.callCheckValueChanged=function(c,a){d.allowEvents&&(retValue=1==d.options.checkBoxSettings.threeState?angular.isDefined(b.events)&&b.events.itemCheckstateChanged?b.events.itemCheckstateChanged({item:c,value:a}):b.itemCheckstateChanged({e:{item:c,value:a}}):angular.isDefined(b.events)&&b.events.itemCheckedChanged?b.events.itemCheckedChanged({item:c,value:a}):b.itemCheckedChanged({e:{item:c,value:a}}))};b.$on(b.name+"-get-check-list",function(c,a){void 0==a&&(a=1==d.options.checkBoxSettings.threeState?"checked":!0);var b=1==d.options.checkBoxSettings.threeState?d.options.dataFields.checkState:d.options.dataFields.checked,f={operation:"=",value:a},b=h.filter(d.getFullList(),b,f);l.setTempData(b)});this.updateCheckBoxSettings=function(c){d.options.checkBoxSettings=c?{autoCheck:f.isFieldAvailable(c.autoCheck,!1),style:G(c.style),threeState:f.isFieldAvailable(c.threeState,!1)}:{autoCheck:!1,style:d.defaultCheckBoxStyle,threeState:!1}};var q=0;d.currentList=[];d.longestItem=null;d.isThereChildItems=!1;var r=function(c,a){c.type="item";c[d.options.dataFields.id]||(c[d.options.dataFields.id]=f.getUniqueId());if(a)d.fullList.push(c);else if(d.currentList.push(c),c[d.options.dataFields.text]){var b=c[d.options.dataFields.text].length;q<b&&(q=b,d.longestItem=c)}};d.fullList=[];this.getFullList=function(c){d.fullList.length=0;c=d.dataObj.getList();for(var a=0;a<c.length;a++)r(c[a],!0);return d.fullList};this.getCurrentList=function(){return d.currentList};this.updateCurrentList=function(){q=d.currentList.length=0;var c=d.dataObj.getList();if(c)for(var a=0;a<c.length;a++)r(c[a],0,null,!1)};this.getDataFields=function(c){return{content:c.content?c.content:"content",icon:c.icon?c.icon:"icon",id:c.id?c.id:"id",objects:c.items?c.items:"items",text:c.text?c.text:"text"}};d.dataObj=new e({objects:b.items,events:{clear:function(c){return angular.isDefined(b.events)&&b.events.clear?b.events.clear({parent:c.e.parent}):b.clear(c)},objAdded:function(c){return angular.isDefined(b.events)&&b.events.itemAdded?b.events.itemAdded({item:c.e.item}):b.itemAdded(c)},objAdding:function(c){return angular.isDefined(b.events)&&b.events.itemAdding?b.events.itemAdding({item:c.e.item}):b.itemAdding(c)},objRemoved:function(c){return angular.isDefined(b.events)&&b.events.itemRemoved?b.events.itemRemoved({item:c.e.item}):b.itemRemoved(c)},objRemoving:function(c){return angular.isDefined(b.events)&&b.events.itemRemoving?b.events.itemRemoving({item:c.e.item}):b.itemRemoving(c)}},fields:d.getDataFields(d.options.dataFields)});b.$on(b.name+"-load-data",function(c,a,b){d.loadData(a,b)});this.loadData=function(c,a){d.allowEvents=!1;d.updateDataFields(a);var m=[];d.dataObj.clear(parent);c&&(m=c);angular.isDefined(b.items)&&(b.items=m);d.dataObj=new e({objects:b.items,events:d.dataEvents,fields:d.getDataFields(d.options.dataFields)});d.updateLayout();d.allowEvents=!0};this.updateDataFields=function(c){c&&(d.options.dataFields={allowFocus:c.allowFocus?c.allowFocus:"allowFocus",checkBoxSettings:c.checkBoxSettings?c.checkBoxSettings:"checkBoxSettings",checked:c.checked?c.checked:"checked",checkState:c.checkState?c.checkState:"checkState",content:c.content?c.content:"content",enabled:c.enabled?c.enabled:"enabled",icon:c.icon?c.icon:"icon",id:c.id?c.id:"id",style:c.style?c.style:"style",text:c.text?c.text:"text"},d.dataObj&&d.dataObj.updateDataFields(d.options.dataFields))};this.updateData=function(){d.options.dataFields.dataSource&&(d.loadData(d.options.dataFields.dataSource),d.dataObj=new e({objects:b.items,events:d.dataEvents,fields:d.getDataFields(d.options.dataFields)}))};this.allowEvents=!0;this.callAfterSelect=function(c){angular.isDefined(b.events)&&b.events.afterSelect?b.events.afterSelect({item:c}):b.afterSelect({e:{item:c}});angular.isDefined(b.events)&&b.events.selectionChanged?b.events.selectionChanged({item:c}):b.selectionChanged({e:{item:c}})};this.callItemClick=function(c,a){angular.isDefined(b.events)&&b.events.itemClick&&b.events.itemClick({item:c,mousePos:a});b.itemClick({e:{item:c,mousePos:a}})};this.callItemDblClick=function(c,a){angular.isDefined(b.events)&&b.events.itemDblClick&&b.events.itemDblClick({item:c,mousePos:a});b.itemDblclick({e:{item:c,mousePos:a}})};this.callItemHover=function(c){angular.isDefined(b.events)&&b.events.itemHover&&b.events.itemHover({item:c});b.itemHover({e:{item:c}})};this.callItemRightClick=function(c,a){angular.isDefined(b.events)&&b.events.itemRightClick&&b.events.itemRightClick({item:c,mousePos:a});b.itemRightclick({e:{item:c,mousePos:a}})};this.callKeyDown=function(c,a){angular.isDefined(b.events)&&b.events.keyDown?b.events.keyDown({event:c,item:a}):b.keyDown({e:{event:c,item:a}})};this.callKeyPress=function(c,a){angular.isDefined(b.events)&&b.events.keyPress?b.events.keyPress({event:c,item:a}):b.keyPress({e:{event:c,item:a}})};this.callKeyUp=function(c,a){angular.isDefined(b.events)&&b.events.keyUp?b.events.keyUp({event:c,item:a}):b.keyUp({e:{event:c,item:a}})};k.bind("click",function(c){1===c.which&&d.callItemClick(null,f.getMousePos(c))});k.bind("dblclick",function(c){c.preventDefault();1===c.which&&d.callItemDblClick(null,f.getMousePos(c));c.stopPropagation()});k.bind("mousedown",function(c){3===c.which&&d.callItemRightClick(null,f.getMousePos(c));c.stopPropagation()});k.bind("mouseleave",function(c){c.preventDefault();d.hoverItem=null});this.getTabIndex=function(){return k[0].attributes&&k[0].attributes.tabindex?k[0].attributes.tabindex.value:""};this.updateFocus=function(c){if(1==d.options.allowFocus)var a=n(function(){if(c){var b=d.getElemFromItem(c);b&&b[0].focus()}else k[0].focus();n.cancel(a)},5)};b.$on(b.name+"-focus",function(c,a){d.updateFocus(a)});this.getElement=function(c,a){var b=null;a||(a="content");if(c)for(var d=c.children(),f=0;f<d.length;f++){var e=angular.element(d.eq(f));if(e[0].attributes&&e[0].attributes["data-element"]&&e[0].attributes["data-element"].value===a){b=e;break}}return b};this.getElemFromItem=function(c){var a=null;if(c){c=d.getItemCurrentIndex(c);var b=k.find("li");if(b&&0<b.length)for(var f=0;f<b.length;f++){var e=angular.element(b[f]);if(e[0].attributes["data-index"]&&e[0].attributes["data-index"].value.toString()===c.toString()){a=e;break}}}return a};this.getItemCurrentIndex=function(c){return c&&d.currentList?d.currentList.indexOf(c):-1};this.getObjCurrentIndex=function(c){return d.getItemCurrentIndex(c)};this.getObjState=function(c){if(c)switch(c.type){case "item":if(0==c[d.options.dataFields.enabled])return"disabled";if(c==d.options.selectedItem)return"selected";if(c==d.hoverItem)return"hovered"}return"normal"};this.getItemFromChildElem=function(c){return c?(c=angular.element(c))?d.getItemFromElem(c[0].parentElement):null:null};this.getItemFromElem=function(c){if(c&&(c=angular.element(c))&&c[0].attributes["data-index"]&&(c=c[0].attributes["data-index"].value,d.isIndexInRange(c)))return d.currentList[c]};this.isIndexInRange=function(c){return 0<=c&&c<d.currentList.length};this.isItemEnabled=function(c){return f.isEnabled(c[d.options.dataFields.enabled])};b.$on(b.name+"-ensure-visible",function(c,a,b){d.ensureVisible(a,b)});b.$on(b.name+"-find-item-by-id",function(c,b){a.setTempData(d.findItemById(b))});b.$on(b.name+"-find-item-by-text",function(c,b){a.setTempData(d.findItemByText(b))});b.$on(b.name+"-get-list",function(c){l.setTempData(d.getList())});this.ensureVisible=function(c,a){c&&(a||(a="center"),d.scrollTo(c,a))};this.findItemById=function(c){return d.dataObj.findObjectById(c)};this.findItemByText=function(c){return d.dataObj.findObjectByText(c)};this.getList=function(){return d.dataObj.getList()};this.getFirstItem=function(){for(var c=null,a=0;a<d.currentList.length;a++)if(d.isItemEnabled(d.currentList[a])){c=d.currentList[a];break}return c};this.getPrevItem=function(c){var a=null;if(0<=c&&c<d.currentList.length)for(--c;0<=c;c--)if(d.isItemEnabled(d.currentList[c])){a=d.currentList[c];break}return a};this.getNextItem=function(c){var a=null;for(c+=1;c<d.currentList.length;c++)if(d.isItemEnabled(d.currentList[c])){a=d.currentList[c];break}return a};this.getLastItem=function(){for(var c=null,a=d.currentList.length-1;0<=a;a--)if(d.isItemEnabled(d.currentList[a])){c=d.currentList[a];break}return c};d.allowUpdate=!0;this.suspendLayout=function(){d.allowUpdate=!1};this.resumeLayout=function(){d.allowUpdate=!0;d.updateLayout()};b.$on(b.name+"-refresh",function(c,a){d.refresh(a)});b.$on(b.name+"-resume-layout",function(c){d.resumeLayout()});b.$on(b.name+"-suspend-layout",function(c){d.suspendLayout()});b.$on(b.name+"-update-layout",function(c){d.updateLayout()});b.$on(b.name+"-update-view",function(c){d.updateView()});b.$on(b.name+"-scroll-to",function(c,a,b){d.scrollTo(a,b)});this.itemSelection=function(c,a,f){if(c)d.isItemEnabled(c)&&(d.itemSelection(),a=!0,a=angular.isDefined(b.events)&&b.events.beforeSelect?b.events.beforeSelect({item:c}):b.beforeSelect({e:{item:c}}),!1!==a&&(d.options.selectedItem=c,c.selected=!0,angular.isDefined(b.selectedItem)&&(b.selectedItem=c),(1==d.options.navSelection||f)&&d.callAfterSelect(c),d.refresh()));else return d.options.selectedItem};this.getItemAt=function(c,a){var b=null,e=null,g=null,h=k.find("li");if(h&&0<h.length)for(var n=0;n<h.length;n++)if(b=angular.element(h[n]),e=f.getPageRect(b),f.checkHit(c,a,e)){g=d.getItemFromElem(b);break}return g};b.$on(b.name+"-get-selected-item",function(c){l.setTempData(d.itemSelection())});b.$on(b.name+"-set-selected-item",function(c,a){d.itemSelection(a)});b.$watch("options.allowFocus",function(c,a){c!==a&&(d.options.allowFocus=c)});b.$watch("allowFocus",function(c,a){c!==a&&(d.options.allowFocus=c)});b.$watch("checkBoxSettings",function(c,a){c!==a&&d.updateCheckBoxSettings(c)});b.$watch("controlStyle",function(c,a){c!==a&&d.updateControlStyle(c)});b.$watch("options.dataFields",function(c,a){c!==a&&(d.updateDataFields(c),d.UpdateData())});b.$watch("fields",function(c,a){c!==a&&(d.options.dataFields=c,d.UpdateData())});b.$watch("options.hoverSelection",function(c,a){c!==a&&(d.options.hoverSelection=c)});b.$watch("hoverSelection",function(a,b){a!==b&&(d.options.hoverSelection=a)});b.$watch("options.itemIcon",function(a,b){a!==b&&(d.options.itemIcon=a,d.updateLayout())});b.$watch("itemIcon",function(a,b){a!==b&&(d.options.itemIcon=a,d.updateLayout())});b.$watch("navSelection",function(a,b){a!==b&&(d.options.navSelection=a,d.updateLayout())});b.$watch("options.rtl",function(a,b){a!==b&&(d.options.rtl=a,d.updateLayout())});b.$watch("rtl",function(a,b){a!==b&&(d.options.rtl=a,d.updateLayout())});b.$watch("options.showCheckBoxes",function(a,b){a!==b&&(d.options.showCheckBoxes=a,d.updateLayout())});b.$watch("showCheckBoxes",function(a,b){a!==b&&(d.options.showCheckBoxes=a,d.updateLayout())});b.$watch("options.showIcons",function(a,b){a!==b&&(d.options.showIcons=a,d.updateLayout())});b.$watch("showIcons",function(a,b){a!==b&&(d.options.showIcons=a,d.updateLayout())});b.$watch("options.showStatusIcons",function(a,b){a!==b&&(d.options.showStatusIcons=a,d.updateLayout())});b.$watch("showStatusIcons",function(a,b){a!==b&&(d.options.showStatusIcons=a,d.updateLayout())});b.$watch("options.selectedItem",function(a,b){a!==b&&(b&&(b.selected=!1),d.options.selectedItem=a,d.callAfterSelect(a))});b.$watch("selectedItem",function(a,b){a!==b&&(b&&(b.selected=!1),d.options.selectedItem=a,d.callAfterSelect(a))});var G=function(a){if(a){var b=f.isFieldAvailable(a.general,"iui-checkbox");a=(a=a.box)?{general:f.isFieldAvailable(a.general,"iui-checkbox-box"),disabled:f.isFieldAvailable(a.disabled,"iui-checkbox-disabled"),checked:f.isFieldAvailable(a.checked,"iui-checkbox-checked"),indeterminate:f.isFieldAvailable(a.indeterminate,"iui-checkbox-indeterminate"),unchecked:f.isFieldAvailable(a.unchecked,"iui-checkbox-unchecked")}:d.options.controlStyle.item.checkBox.box;return{general:b,box:a}}return d.options.controlStyle.item.checkBox},z=function(a){if(a){var b;b=a.general;b=f.isString(b)?b:b?{disabled:f.isFieldAvailable(b.disabled,"iui-list-item-disabled"),focused:f.isFieldAvailable(b.focused,"iui-list-item-focused"),normal:f.isFieldAvailable(b.normal,"iui-list-item"),hovered:f.isFieldAvailable(b.hovered,"iui-list-item-hovered"),selected:f.isFieldAvailable(b.selected,"iui-list-item-selected")}:d.options.controlStyle.item.general;var e=G(a.checkBox);a=a.content;a=f.isString(a)?a:a?{disabled:f.isFieldAvailable(a.disabled,"iui-list-item-content-disabled"),focused:f.isFieldAvailable(a.focused,"iui-list-item-content-focused"),normal:f.isFieldAvailable(a.normal,"iui-list-item-content"),hovered:f.isFieldAvailable(a.hovered,"iui-list-item-content-hovered"),selected:f.isFieldAvailable(a.selected,"iui-list-item-content-selected")}:d.options.controlStyle.item.content;return{general:b,checkBox:e,content:a}}return d.options.controlStyle.item};this.updateControlStyle=function(a){d.options.controlStyle=a?{general:f.isFieldAvailable(a.general,"iui-list"),item:z(a.item)}:{general:f.isFieldAvailable(d.defaultStyle.general,"iui-list"),item:z(d.defaultStyle.item)}};this.getCurrentItemStyle=function(a,b){var e=d.options.controlStyle.item;if(a)switch(a.style){case "initial":break;case "parent":return d.getCurrentItemStyle(d.getParent(a),b);default:null!=a.style&&(e=a.style)}if(b){if(f.isString(e.general))return e.general;switch(b){case "disabled":return e.general&&e.general.disabled?e.general.disabled:d.options.controlStyle.item.general.disabled;case "focused":return e.general&&e.general.focused?e.general.focused:d.options.controlStyle.item.general.focused;case "hovered":return e.general&&e.general.hovered?e.general.hovered:d.options.controlStyle.item.general.hovered;case "selected":return e.general&&e.general.selected?e.general.selected:d.options.controlStyle.item.general.selected;default:return e.general&&e.general.normal?e.general.normal:d.options.controlStyle.item.general.normal}}else return e?e:d.options.controlStyle.item};this.getCurrentItemContentStyle=function(a,b){var e=d.options.controlStyle.item.content;if(a)switch(a.style){case "initial":break;case "parent":return d.getCurrentItemContentStyle(d.getParent(a),b);default:null!=a.style&&a.style.content&&(e=a.style.content)}if(b){if(f.isString(e))return e;switch(b){case "disabled":return e&&e.disabled?e.disabled:d.options.controlStyle.item.content.disabled;case "focused":return e&&e.focused?e.focused:d.options.controlStyle.item.content.focused;case "hovered":return e&&e.hovered?e.hovered:d.options.controlStyle.item.content.hovered;case "selected":return e&&e.selected?e.selected:d.options.controlStyle.item.content.selected;default:return e&&e.normal?e.normal:d.options.controlStyle.item.content.normal}}else return e?e:d.options.controlStyle.item.content}}]).directive("iuiList",["$compile","$timeout","IntegralUIInternalService","$window",function(b,k,n,g){return{restrict:"EA",controller:"IntegralUIListCtrlController",transclude:!0,replace:!0,template:'<div class="iui-list" data-element="list"><ul class="iui-list-block"></ul></div>',scope:{allowFocus:"=",checkboxSettings:"=",controlStyle:"=",fields:"=",itemIcon:"=",items:"=",navSelection:"=",name:"@",options:"=?",rtl:"=",selectedIndex:"=",selectedItem:"=",showCheckBoxes:"=",showIcons:"=",afterSelect:"&",beforeSelect:"&",clear:"&",events:"=?",itemAdded:"&",itemAdding:"&",itemCheckedChanging:"&",itemCheckedChanged:"&",itemCheckstateChanging:"&",itemCheckstateChanged:"&",itemClick:"&",itemDblclick:"&",itemHover:"&",keyDown:"&",keyPress:"&",keyUp:"&",itemRemoved:"&",itemRemoving:"&",itemRightclick:"&",scrollposChanged:"&",selectionChanged:"&"},link:function(f,e,l,a,h){var d=this,q=e.children().eq(0),r=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),G=function(){var b="iui-list-block";a.options.showStatusIcons&&(b+=" "+b+"-shift-left");a.options.rtl&&(b+=" "+b+"-rtl");return b};f.$on("destroy",function(a){e.unbind("click dblclick keydown mousedown mouseleave mousemove mousewheel scroll");angular.element(g).unbind("mousemove mouseup");z();m&&m.$destroy()});var z=function(){var a=q.find("li");if(0<a.length)for(var b=0;b<a.length;b++)currentElem=angular.element(a[b]),currentElem.unbind("click dragstart dragover drop dragenter dragleave dblclick keydown keypress keyup mouseenter mouseleave mousedown mouseup")},c=function(b){if(b){if(1==a.options.allowFocus){var c=a.getTabIndex().toString()+(a.getItemCurrentIndex(a.getItemFromElem(b))+1).toString();b.attr("tabindex",c)}b.bind("click",function(b){if(1===b.which){var c=a.getItemFromElem(this);c&&a.callItemClick(c,n.getMousePos(b))}b.stopPropagation()});b.bind("dblclick",function(b){b.preventDefault();if(1===b.which){var c=a.getItemFromElem(this);c&&a.callItemDblClick(c,n.getMousePos(b))}b.stopPropagation()});b.bind("mousedown",function(a){});b.bind("mouseup",function(b){var c=a.getItemFromElem(this);if(c)switch(a.itemSelection(c,!0,!0),b.which){case 1:a.changeCheckValue(c);break;case 3:a.callItemRightClick(c,n.getMousePos(b))}b.stopPropagation()});b.bind("mouseenter",function(b){if(b=a.getItemFromElem(this))angular.element(this),a.hoverItem=b,a.refresh(),a.callItemHover(b)});b.bind("mouseleave",function(b){a.hoverItem=null;a.getItemFromElem(this)&&a.refresh()})}var d=function(b,c){b.preventDefault();focusDelayTime=0;var d=a.getItemCurrentIndex(c),B=t+x-2,B=B<a.currentList.length-1?B:a.currentList.length-1;d===B&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(e[0].clientHeight/4)}),focusDelayTime=1);var p=a.getNextItem(d);if(p){a.itemSelection(p);f.$apply();var I=k(function(){a.updateFocus(p);k.cancel(I)},focusDelayTime)}},I=function(b,c){b.preventDefault();focusDelayTime=0;var d=a.getItemCurrentIndex(c),B=t;d===(0<B?B:0)&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(e[0].clientHeight/4)}),focusDelayTime=1);var p=a.getPrevItem(a.getItemCurrentIndex(c));if(p){a.itemSelection(p);f.$apply();var I=k(function(){a.updateFocus(p);k.cancel(I)},focusDelayTime)}};b.bind("keydown",function(b){var c=a.getItemFromElem(this);if(c){var e=0;switch(b.keyCode){case 9:var p=a.currentList.length;0<p&&(b.shiftKey?n.isEqual(c[a.options.dataFields.id],a.currentList[0][a.options.dataFields.id])||I(b,c):n.isEqual(c[a.options.dataFields.id],a.currentList[p-1][a.options.dataFields.id])||d(b,c));break;case 13:a.itemSelection(c,!0,!0);break;case 33:b.preventDefault();e=a.getItemCurrentIndex(c);p=e-x;p=0<p?p:0;if(p!==e){var e=1,g=a.getPrevItem(p+1);if(g){a.scrollTo(g);a.itemSelection(g);f.$apply();var h=k(function(){a.updateFocus(g);k.cancel(h)},e)}}break;case 34:b.preventDefault();e=a.getItemCurrentIndex(c);p=e+x;p=p<a.currentList.length-1?p:a.currentList.length-1;p!==e&&(e=1,g=a.getNextItem(p-1))&&(a.scrollTo(g,"bottom"),a.itemSelection(g),f.$apply(),h=k(function(){a.updateFocus(g);k.cancel(h)},e));break;case 35:b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:J.y});var m=a.getLastItem();m&&(a.itemSelection(m),h=k(function(){a.updateFocus(m);k.cancel(h)},1));break;case 36:b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var S=a.getFirstItem();S&&(a.itemSelection(S),h=k(function(){a.updateFocus(S);k.cancel(h)},1));break;case 38:I(b,c);break;case 40:d(b,c);break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}}a.callKeyDown(b,c)});b.bind("keyup",function(b){var c=a.getItemFromElem(this);a.callKeyUp(b,c)});b.bind("keypress",function(b){var c=a.getItemFromElem(this);a.callKeyPress(b,c)})},t=0,m=null,u=100,w=0,x=0,F=0,A=0,D=!1,K=9,M=0,L=0,C=0,H=0,N=1,v=null,y=!1;this.scrollMousePos=null;var J={x:0,y:0},L=0;a.updateViewSize=function(){var c=k(function(){y=!1;if(0<a.currentList.length){var g=angular.element(b(W(0,!0))(f));e.append(g);var B=n.getMargin(g[0]);w=g[0].offsetHeight+(B.top+B.bottom);u=Math.floor((e[0].offsetHeight-6)/w)+1;y=!1;u<a.currentList.length+1&&(r.unbind("mousedown"),e.append(r),r.bind("mousedown",function(b){b=n.getClientMousePos(b,this);var c=Math.floor(e[0].clientHeight);v&&(b.y<v[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-c}),X(!1,c)):b.y>v[0].offsetTop+v[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+c}),X(!0,c)))}),v=angular.element(r.children().eq(0)),y=!0,v.bind("mousedown",function(a){1===a.which&&(d.scrollMousePos=n.getMousePos(a),D=!0);a.stopPropagation()}));g.remove()}y||(r.unbind("mousedown"),r.remove());k.cancel(c);!y&&0<a.scrollPos.y&&a.setScrollPos({x:0,y:0})},1)};var T=function(){var b=k(function(){F=e[0].offsetWidth-6;A=e[0].offsetHeight-6;A-=4;F=y?F-r[0].offsetWidth:F-4;q.css("width",F+"px");q.css("height",A+"px");y&&(r.css("top","0px"),A+=3,r.css("height",A+1+"px"));!1!==a.options.rtl?(q.css("left","auto"),q.css("right","-"+(a.scrollPos.x-2).toString()+"px"),y&&(r.css("left","0px"),r.css("right","auto"))):(q.css("left","-"+(a.scrollPos.x-2).toString()+"px"),q.css("right","auto"),y&&(r.css("left","auto"),r.css("right","0px")));var c=k(function(){var b=a.currentList.length+1;y&&0<a.currentList.length&&u<b&&(C=2,H=r[0].clientHeight-4,M=0,H>C&&(M=H-C),K=Math.floor(M*u/b),9>K&&(K=9),v.css("height",K+"px"),N=(b-u)/(M-K-2),J.y=(b-u)*w,0>J.y&&(J.y=0),0==t?v.css("top",C+"px"):t+u-1==a.currentList.length&&v.css("top",H-v[0].offsetHeight+"px"));k.cancel(c)},1);k.cancel(b)},5)};a.updateLayout=function(b){a.allowUpdate&&(e.removeClass("iui-list-block-rtl"),a.options.rtl&&e.addClass("iui-list-block-rtl"),q.removeClass("iui-list-block-shift-left iui-list-block-rtl"),q.addClass(G()),w=0,u=100,u=Math.floor(e[0].clientHeight/20),a.updateCurrentList(),Y(),a.updateView(b),a.updateView(b),k(function(){a.updateViewSize();a.updateViewSize();T()},1))};f.onCheckValueChanging=function(b,c){return a.callCheckValueChanging(a.currentList[c],a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?b.checkState:b.checked)};f.onCheckValueChanged=function(b,c){a.callCheckValueChanged(a.currentList[c],a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?b.checkState:b.checked)};var W=function(b,c){var d=a.currentList[b],e=a.defaultStyle.item.general.normal,f=a.getCurrentItemStyle(d,a.getObjState(d)),d='<li class="'+e;f!=e&&(d+=" "+f);d+='" ';d=(c?d+'style="position:absolute;top:-9999px;':d+('data-index="'+b+'"'))+">";1==a.options.showCheckBoxes&&(d+='<iui-checkbox name="cb-'+n.getUniqueId(4)+'"',e=a.options.checkBoxSettings?1==a.options.checkBoxSettings.threeState:!1,f=a.currentList[b],e&&void 0==f[a.options.dataFields.checkState]?f[a.options.dataFields.checkState]="unchecked":void 0==f[a.options.dataFields.checked]&&(f[a.options.dataFields.checked]=!1),e?(d+=' check-state="data['+b+"]."+a.options.dataFields.checkState+'"',d+=' checkstate-changing="onCheckValueChanging(e, '+b+')"',d+=' checkstate-changed="onCheckValueChanged(e, '+b+')"',d+=' three-state="true"'):(d+=' checked="data['+b+"]."+a.options.dataFields.checked+'"',d+=' checked-changing="onCheckValueChanging(e, '+b+')"',d+=' checked-changed="onCheckValueChanged(e, '+b+')"'),a.options.checkBoxSettings&&a.options.checkBoxSettings.style&&m.checkBoxStyle?d+=' control-style="checkBoxStyle"':a.options.controlStyle.item.checkBox&&m.checkBoxStyle&&(d+=' control-style="checkBoxStyle"'),a.isItemEnabled(a.currentList[b])||(d+=' enabled="false"'),d+=' style="display:inline-block;margin:0 2px;padding-bottom:2px;vertical-align:middle;',0<O&&(d+="width: "+O+"px;"),d+='"></iui-checkbox>');!1!==a.options.showIcons&&(a.currentList[b].icon||a.options.itemIcon)&&(e=a.currentList[b],f="",e[a.options.dataFields.icon]?f=e[a.options.dataFields.icon]:a.options.itemIcon&&(f=a.options.itemIcon),d+='<span class="'+f+'" data-element="icon"></span>');e=a.defaultStyle.item.content.normal;a.options.controlStyle.item.content.normal!=e&&(e+=" "+a.options.controlStyle.item.content.normal);f=a.getCurrentItemContentStyle(a.currentList[b],"normal");a.currentList[b].content?(d+='<div class="'+e+" "+f+'" data-element="content">',d+=a.currentList[b][a.options.dataFields.content],d+="</div>"):(d+='<span class="'+e+" "+f+'" data-element="content"',!c&&a.currentList[b].contextMenu&&(d+=' iui-contextmenu menu-items="data['+b+'].contextMenu"'),d+=">",d=c?d+a.currentList[b][a.options.dataFields.text]:d+("{{data["+b+"]."+a.options.dataFields.text+"}}"),d+="</span>");return d+="</li>"},O=0,Y=function(){if(1==a.options.showCheckBoxes){var c=angular.element(b('<iui-checkbox style="position:absolute;top:-9999px"></iui-checkbox>')(f));e.append(c);O=0;c&&0<c.children().length&&(O=parseInt(getComputedStyle(angular.element(c.children().eq(0))[0]).width,10));c.remove()}};a.updateView=function(d){var g=k(function(){D||T();z();q.empty();m&&m.$destroy();U(!1);a.currentList.length>=u&&t+u-1>a.currentList.length&&(t=a.currentList.length-u+1);if(t<a.currentList.length){m=f.$new();m.data=a.currentList;m.checkBoxStyle=a.options.checkBoxSettings.style;!m.checkBoxStyle&&a.options.controlStyle.item.checkBox&&(m.checkBoxStyle=a.options.controlStyle.item.checkBox);x=0;var d="";firstItemElem=d=null;for(var p=n.getMargin(),h=0,l=t;l<t+u&&l<a.currentList.length;l++)d=W(l),d=a.currentList[l].content?b(d)(f.$parent):b(d)(m),d=angular.element(d),q.append(d),p=n.getMargin(d[0]),h+=d[0].offsetHeight+(p.top+p.bottom),x++;if(0<x){l=null;d=q.find("li");if(0<d.length)for(var p=null,r=0;r<d.length;r++)p=angular.element(d[r]),(l=a.getItemFromElem(p))&&a.isItemEnabled(l)&&c(p);l=e[0].offsetHeight-6;w=h/x;u=Math.floor(l/w)+1;T()}a.refresh()}k.cancel(g)},1)};a.refresh=function(b,c){if(b){var d=null;switch(b.type){case "item":if(d=a.getElemFromItem(b)){d.removeAttr("class");d.addClass(a.defaultStyle.item.general.normal);d.addClass(a.options.controlStyle.item.general.normal);var e=a.getCurrentItemStyle(b,a.getObjState(b));e!=a.options.controlStyle.item.general.normal&&d.addClass(e);if(d=a.getElement(d))d.removeAttr("class"),d.addClass(a.defaultStyle.item.content.normal),d.addClass(a.options.controlStyle.item.content.normal),e=a.getCurrentItemContentStyle(b,a.getObjState(b)),e!=a.options.controlStyle.item.content.normal&&d.addClass(e)}}}else for(e=t;e<t+u&&e<a.currentList.length;e++)a.refresh(a.currentList[e])};var P=!1,E=0,Q=null,R=.5;a.isScrollBarVisible=function(){return y};a.scrollPos={x:0,y:0};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b){b&&(b.x=0,0>b.y&&(b.y=0),b.y>J.y&&(b.y=J.y),a.scrollPos=b,L=Math.floor(a.scrollPos.y/(w*N)),b=C+L,y&&v&&v.css("top",b+"px"),U(),angular.isDefined(f.events)&&f.events.scrollPosChanged?f.events.scrollPosChanged({scrollPos:a.scrollPos}):f.scrollposChanged({e:{scrollPos:a.scrollPos}}))};var X=function(b,c,d){P||(E=0,P=!0,Q=$interval(function(){var d=c,e=a.getScrollPos();d||(0===E&&(E=5),E+=5+N,R+=.5,d=E+=Math.floor(R));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&V()},d?d:100))},V=function(){P&&(Q&&($interval.cancel(Q),Q=null),P=!1,E=0,R=.5)};a.cancelScrollTimer=function(){V()};a.scrollTo=function(b,c){if(b){var d=a.getItemCurrentIndex(b);if(a.isIndexInRange(d)){var e=0,f=d;switch(c){case "center":e=Math.floor(x/2);f=d>e?d-e:0;break;case "bottom":e=x-2,f=d>e?d-e:0}var g=k(function(){a.setScrollPos({x:a.scrollPos.x,y:f*w});k.cancel(g)},1)}}};var U=function(b){0==b&&0>=w||(newIndex=0<w?Math.floor(a.scrollPos.y/w):0,newIndex+u-1>a.currentList.length&&(newIndex=a.currentList.length-u+1),0>newIndex&&(newIndex=0),newIndex!==t&&(t=newIndex,0!=b&&a.updateView(!0)))};e.bind("scroll",function(a){e[0].scrollTop=0;e[0].scrollLeft=0});e.bind("mousewheel",function(b){b.preventDefault();a.hoverItem=null;var c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(e[0].clientHeight/4)*c*-1});k(function(){var c=n.getMousePos(b),d=angular.element(g)[0].pageXOffset,e=angular.element(g)[0].pageYOffset;c.x-=d;c.y-=e;if(c=a.getItemAt(c.x,c.y))a.hoverItem=c,a.refresh()},1)});angular.element(g).bind("mousemove",function(b){if(D&&1===b.which){v[0].getBoundingClientRect();b=n.getMousePos(b);d.scrollMousePos||(d.scrollMousePos=b);var c=v[0].offsetTop+(b.y-d.scrollMousePos.y);c<C?c=C:c+v[0].offsetHeight>H&&(c=H-v[0].offsetHeight);v.css("top",c+"px");d.scrollMousePos=b;L=c-C;a.scrollPos.y=Math.floor(L*N*w);U()}});angular.element(g).bind("mouseup",function(b){D&&a.updateView();V();d.scrollMousePos=null;D=!1});angular.isDefined(f.options)?(a.options=f.options,a.updateData()):(0==f.allowFocus&&(a.options.allowFocus=f.allowFocus),angular.isDefined(f.checkboxSettings)&&a.updateCheckBoxSettings(f.checkboxSettings),angular.isDefined(f.controlStyle)&&a.updateControlStyle(f.controlStyle),angular.isDefined(f.fields)&&(a.updateDataFields(f.fields),a.updateData()),angular.isDefined(f.itemIcon)&&(a.options.itemIcon=f.itemIcon),angular.isDefined(f.navSelection)&&(a.options.navSelection=f.navSelection),!0===f.rtl&&(a.options.rtl=f.rtl),angular.isDefined(f.selectedIndex)&&(a.options.selectedIndex=f.selectedIndex),angular.isDefined(f.selectedItem)&&(a.options.selectedItem=f.selectedItem),!0===f.showCheckBoxes&&(a.options.showCheckBoxes=f.showCheckBoxes),!1===f.showIcons&&(a.options.showIcons=f.showIcons));a.updateLayout()}}}]);